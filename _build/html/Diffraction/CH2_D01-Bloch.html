

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>2.16. Bethe Theory &#8212; Introduction to Transmisison Electron Microscopy</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Diffraction/CH2_D01-Bloch';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.17. Multislice Algorithm" href="CH2_D02-Multislice.html" />
    <link rel="prev" title="2.13. Lattice Determination with HOLZ" href="CH2_12-HOLZ_Example.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Introduction to Transmisison Electron Microscopy - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Introduction to Transmisison Electron Microscopy - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Foreword (ReadME)
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Introduction/CH1_00-Introduction.html">1. Chapter 1: Introduction</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Introduction/CH1_01-Introduction_Python.html">1.1. Introduction to Python as it is used in this lecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Introduction/CH1_02-Prerequisites.html">1.2. Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Introduction/CH1_03-Data_Representation.html">1.3. Matplotlib and Numpy for Micrographs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Introduction/CH1_04-Open_File.html">1.4. Open DM3 Images, Spectra, Spectrum-Images and  Image-Stacks with pyNSID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Introduction/CH1_05-Course_Organization.html">1.5. Course Organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Introduction/CH1_06-Overview.html">1.6. Overview Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Introduction/install_conda.html">1.7. Installation on your own computer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Introduction/computer_resources.html">1.8. Setting up computing resources</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="CH2_00-Diffraction.html">2. Chapter 2:  Diffraction</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="CH2_01-Electron.html">2.2. The Electron</a></li>
<li class="toctree-l2"><a class="reference internal" href="CH2_02-Atomic_Form_Factor.html">2.3. Atomic Form Factor</a></li>
<li class="toctree-l2"><a class="reference internal" href="CH2_03-Basic_Crystallography.html">2.4. Basic Crystallography</a></li>
<li class="toctree-l2"><a class="reference internal" href="CH2_04-Structure_Factors.html">2.5. Structure Factors</a></li>
<li class="toctree-l2"><a class="reference internal" href="CH2_05-Diffraction_Rings.html">2.6. Analyzing Ring Diffraction Pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="CH2_06-Kinematic_Scattering_Geometry.html">2.7. Kinematic Scattering Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="CH2_07-Plotting_Diffraction_Pattern.html">2.8. Plotting Diffraction Pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="CH2_08-Spot_Diffraction_Pattern.html">2.9. Analyzing Spot Diffraction Pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="CH2_09-Unit_Cell.html">2.10. Unic Cell Determination and Stereographic Projection</a></li>
<li class="toctree-l2"><a class="reference internal" href="CH2_10-Kikuchi_Lines.html">2.11. Kikuchi Lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="CH2_11-HOLZ_Lines.html">2.12. HOLZ Lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="CH2_12-HOLZ_Example.html">2.13. Lattice Determination with HOLZ</a></li>


<li class="toctree-l2 current active"><a class="current reference internal" href="#">2.16. Bethe Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="CH2_D02-Multislice.html">2.17. Multislice Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="CH2_D03-Multislice_CBED.html">2.18. CBED - Multislice Algorithm</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Imaging/CH3_00-Imaging.html">3. Chapter 3: Imaging</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Imaging/CH3_01-Resolution.html">3.2. Resolution Limit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Imaging/CH3_03-CTF.html">3.3. Contrast Transfer Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Imaging/CH3_04-Linear_Image_Approximation.html">3.4. Linear Image Approximation: Weak Phase Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Imaging/CH3_05-Defocus_Thickness.html">3.5. Defocus-Thickness Map with Multislice Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Imaging/CH3_06-Image_Processing.html">3.6. Image Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Imaging/CH3_07-Image_Analysis.html">3.7. Image Analysis</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Imaging/CH3_08-Thermal_Diffuse_Scattering.html">3.9. Thermal-Diffuse Scattering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Imaging/CH3_09-Z_Contrast.html">3.10. Z-Contrast Imaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Imaging/CH3_10-Ronchigram.html">3.11. Ronchigram</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Spectroscopy/CH4_00-Spectroscopy.html">4. Chapter 4: Spectroscopy</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Spectroscopy/CH4_01-Introduction.html">4.1. Introduction to  Electron Energy-Loss Spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Spectroscopy/CH4_02-Fit_Zero_Loss.html">4.2. Fit of Zero-Loss Peak</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Spectroscopy/CH4_03-Drude.html">4.3. Analysing Low-Loss Spectra with Drude Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Spectroscopy/CH4_07-Introduction_Core_Loss.html">4.4. Introduction to Core-Loss Spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Spectroscopy/CH4_08-Chemical_Composition.html">4.5. Chemical Composition in Core-Loss Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Spectroscopy/CH4_09-Analyse_Core_Loss.html">4.6. Analysis of Core-Loss Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Spectroscopy/CH4_10-ELNES.html">4.7. Energy-Loss Near-Edge Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Spectroscopy/CH4_12-Introduction_X_Rays.html">4.8. Chapter 4 <span class="xref myst">Spectroscopy</span></a></li>

<li class="toctree-l2"><a class="reference internal" href="../Spectroscopy/CH4_13-Bremsstrahlung.html">4.10. Chapter 4 <span class="xref myst">Spectroscopy</span></a></li>

<li class="toctree-l2"><a class="reference internal" href="../Spectroscopy/CH4_14-Characteristic_X_Rays.html">4.12. Chapter 4 <span class="xref myst">Spectroscopy</span></a></li>

<li class="toctree-l2"><a class="reference internal" href="../Spectroscopy/CH4_15-Detector.html">4.14. Chapter 4 <span class="xref myst">Spectroscopy</span></a></li>



<li class="toctree-l2"><a class="reference internal" href="../Spectroscopy/CH4_16-Analyze_EDS_Spectrum.html">4.18. Chapter 4 <span class="xref myst">Spectroscopy</span></a></li>


<li class="toctree-l2"><a class="reference internal" href="../Spectroscopy/CH4_17-Quantify_EDS_Spectrum.html">4.21. Chapter 4 <span class="xref myst">Spectroscopy</span></a></li>




</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Homework/homework.html">5. Homework</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Homework/Homework01.html">5.1. Homework 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Homework/Homework02.html">5.2. Homework 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Homework/Homework03.html">5.3. Homework 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Homework/Homework04.html">5.4. Homework 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Homework/Homework05-CBED.html">5.5. HW5:  Analyzing CBED Pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Homework/Homework06-TwoBeam.html">5.6. HW6:  Analyzing CBED Pattern in Two Beam Condition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Homework/Homework07-Dynamic_CBED.html">5.7. HW7:  Simulating CBED Pattern</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/gduscher/MSE672-Introduction-to-TEM/main?urlpath=tree/docs/Diffraction/CH2_D01-Bloch.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/gduscher/MSE672-Introduction-to-TEM" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/gduscher/MSE672-Introduction-to-TEM/issues/new?title=Issue%20on%20page%20%2FDiffraction/CH2_D01-Bloch.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Diffraction/CH2_D01-Bloch.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Bethe Theory</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-numerical-and-plotting-python-packages">2.16.1. Import numerical and plotting python packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notation">2.16.2. Notation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-bethe-theory">2.16.3. Introduction to Bethe Theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hamiltonian-in-bethe-theory">2.16.3.1. Hamiltonian in Bethe Theory</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#schrodinger-equation-of-bethe-theory">2.16.4. Schrödinger  Equation of Bethe Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bloch-waves-in-bethe-theory">2.16.5. Bloch Waves in Bethe Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#crystal-potential-in-bethe-theory">2.16.6. Crystal Potential in Bethe Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-of-bethe-theory">2.16.7. Solution of Bethe Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-beam-case">2.16.8. Two Beam Case</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-bethe-theory">2.16.9. Summary of Bethe Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-bethe-theory-for-thickness-determination">2.16.10. Using Bethe Theory for Thickness Determination</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#experimental-considerations">2.16.10.1. Experimental Considerations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thickness-determination">2.16.10.2. Thickness Determination</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-analysis">2.16.10.3. Data Analysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-about-bloch-waves">2.16.11. More about Bloch Waves</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#navigation">2.16.12. Navigation</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><font size = "5"> <strong>Chapter 2: <a class="reference internal" href="CH2_00-Diffraction.html"><span class="doc std std-doc">Diffraction</span></a></strong> </font></p>
<hr style="height:1px;border-top:4px solid #FF8200" />
<section class="tex2jax_ignore mathjax_ignore" id="bethe-theory">
<h1><span class="section-number">2.16. </span>Bethe Theory<a class="headerlink" href="#bethe-theory" title="Permalink to this heading">#</a></h1>
<p><a class="reference external" href="https://raw.githubusercontent.com/gduscher/MSE672-Introduction-to-TEM//main/Diffraction/CCH2_D01-Bloch.ipynb">Download</a></p>
<p>part of</p>
<p><font size = "5"> <strong><a class="reference internal" href="../_MSE672_Intro_TEM.html"><span class="doc std std-doc">MSE672:  Introduction to Transmission Electron Microscopy</span></a></strong></font></p>
<p>by Gerd Duscher, Spring 2023</p>
<p>Microscopy Facilities<br>
Institute of Advanced Materials &amp; Manufacturing<br>
Materials Science &amp; Engineering<br>
The University of Tennessee, Knoxville</p>
<p>Background and methods to analysis and quantification of data acquired with transmission electron microscopes</p>
<section id="import-numerical-and-plotting-python-packages">
<h2><span class="section-number">2.16.1. </span>Import numerical and plotting python packages<a class="headerlink" href="#import-numerical-and-plotting-python-packages" title="Permalink to this heading">#</a></h2>
<p>Import the python packages that we will use:</p>
<p>We will use only the basic numerical (numpy) and plotting (pylab of matplotlib) libraries:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span>  notebook
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="notation">
<h2><span class="section-number">2.16.2. </span>Notation<a class="headerlink" href="#notation" title="Permalink to this heading">#</a></h2>
<p>In the following I will introduce this Bethe diffraction theory in Dirac’s  bra–ket notation.
$<span class="math notranslate nohighlight">\(
|\psi\rangle = {\rm ket} = \psi_1 |1\rangle + \psi_2 |2\rangle
= \left( \begin{array}{c} \psi_1 \\\psi_2  \end{array} \right)= {\rm column\ vector}\\
\langle \phi| = {\rm bra} = \phi^*_1\langle 1|  + \phi^*_2 \langle 2|
= \left( \phi^*_1 ,\phi^*_2 \right)= {\rm row\ vector}
\)</span><span class="math notranslate nohighlight">\(
Consequently the Dirac &quot;bracket&quot; is:
\)</span><span class="math notranslate nohighlight">\(
\langle \phi|\psi\rangle = \left( \phi^*_1 ,\phi^*_2 \right) \left( \begin{array}{c} \psi_1 \\\psi_2  \end{array} \right) = \phi^*_1 \psi_1 +\phi^*_2 \psi_2
\)</span>$</p>
<p>Similarly</p>
<div class="math notranslate nohighlight">
\[
|\psi\rangle \langle \phi| = {\rm a\ matrix}
\]</div>
<p>and this will make it easier to follow the equations of many beams in diffraction, which otherwise can become very messy.</p>
<p>Throughout this chapter we will use the notation for the wave vector common in solid state physics and not the one found in many crystallography books (<span class="math notranslate nohighlight">\(k=1/\lambda\)</span>):
\begin{equation}
k = \frac{2\pi}{\lambda} = \frac{\sqrt{2meE}}{\hbar}
\end{equation}
with:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\lambda\)</span>: wavelength</p></li>
<li><p><span class="math notranslate nohighlight">\(m=\gamma_0\)</span>: relativistically corrected mass of the electron</p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma = 1+\frac{e^2E^2}{2m_0c^2}\)</span>: relativistic correction necessary for <span class="math notranslate nohighlight">\(E\)</span> above 2kV</p></li>
<li><p><span class="math notranslate nohighlight">\(e\)</span>: electron charge</p></li>
<li><p><span class="math notranslate nohighlight">\(E\)</span>: acceleration voltage</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span>: speed of light in vacuum</p></li>
</ul>
<p>This is the short version of quantum mechanics. The Axioms of quantum mechanics are:</p>
<ol class="arabic simple">
<li><p>The state of a system is described by its state vector <span class="math notranslate nohighlight">\(|\psi\rangle\)</span>.</p></li>
<li><p>An observables are expressed by hermitic operators <span class="math notranslate nohighlight">\(A\)</span></p></li>
<li><p>The mean value of an observable is given by <span class="math notranslate nohighlight">\(\langle A \rangle\)</span></p></li>
<li><p>The time dependence is given by the time-dependent Schrödinger<br />
equation: <span class="math notranslate nohighlight">\( H|\psi,t\rangle = i\hbar \frac{\partial}{\partial t} |\psi,t\rangle \)</span></p></li>
<li><p>If you measure <span class="math notranslate nohighlight">\(A\)</span> the system changes to <span class="math notranslate nohighlight">\(|n\rangle\)</span> if <span class="math notranslate nohighlight">\(a_n\)</span> was measured</p></li>
</ol>
<p>Axioms 2. and 3. give:</p>
<p>If a system is in the state <span class="math notranslate nohighlight">\(|\psi\rangle = \sum_n c_n |n\rangle\)</span></p>
<p>with <span class="math notranslate nohighlight">\(c_n = \langle n|\psi\rangle\)</span>, where <span class="math notranslate nohighlight">\(|n\rangle\)</span> are the Eigen states of <span class="math notranslate nohighlight">\(A\)</span>, meaning <span class="math notranslate nohighlight">\(A|n\rangle = a_n |n\rangle\)</span>. The probability to find the value <span class="math notranslate nohighlight">\(a_n\)</span> when measuring <span class="math notranslate nohighlight">\(A\)</span> is given by <span class="math notranslate nohighlight">\(|c_n|^2\)</span>.</p>
</section>
<section id="introduction-to-bethe-theory">
<h2><span class="section-number">2.16.3. </span>Introduction to Bethe Theory<a class="headerlink" href="#introduction-to-bethe-theory" title="Permalink to this heading">#</a></h2>
<p>The dynamic theory calculates the probability of a transition from an initial state <span class="math notranslate nohighlight">\(|i\rangle\)</span> to a final state <span class="math notranslate nohighlight">\(|f\rangle\)</span>. In our case, the initial state <span class="math notranslate nohighlight">\(|i\rangle\)</span> is the incoming beam which scatters to a final state the Bragg reflection <span class="math notranslate nohighlight">\(|f\rangle\)</span>.
What we want to know is the transition probability from the initial to the final state:
\begin{equation}
\omega_{i\rightarrow f} =  \langle i |T|f\rangle
\end{equation}
the initial state is the beam with wave vector <span class="math notranslate nohighlight">\(\vec{k}_0\)</span> and the end state is a wave-vector of diffracted beam according to Bragg’s law <span class="math notranslate nohighlight">\(\vec{q} = \vec{g}\)</span>.
The above equation now looks like this:
\begin{equation}
\omega_{0\rightarrow g} = \langle 0 |T|g\rangle
\end{equation}</p>
<p>For the stationary problems the states <span class="math notranslate nohighlight">\(|\psi,t\rangle\)</span> can be expressed as:
\begin{equation}
|\psi_n,t\rangle = \exp(-E_nt/\hbar) |\psi_n\rangle
\end{equation}
and we get the time-independent Schröinger equation for <span class="math notranslate nohighlight">\(|\psi_n\rangle\)</span>:
\begin{equation}
H|\psi_n\rangle = E_n |\psi_n \rangle
\end{equation}</p>
<p>For the incoming wave, we get:</p>
<p>\begin{equation}
H_0 = { -\frac{h^2}{8\pi^2} \nabla^2 }
\end{equation}
which expresses the kinetic energy.</p>
<p>Within a crystal the Hamiltonian will change to:
\begin{equation}<br />
H = H_0 + V
\end{equation}
We have  the Schrödinger equation for the incoming wave:
\begin{equation}
(H_0 ) |\vec{k}\rangle = E_k |\vec{k}\rangle
\end{equation}</p>
<p>and we want to solve:
\begin{equation}
(H_0 +V) |\psi\rangle = E_k |\psi\rangle
\end{equation}</p>
<p>which we transform with equation \ref{IncomingWave}:</p>
<blockquote>
<div><p>Effectively, we changed in the integral equation.</p>
</div></blockquote>
<p>\begin{equation*}
|\psi\rangle = |\vec{k}\rangle + \frac{1}{E_k -H_0}V|\psi\rangle
\end{equation*}</p>
<section id="hamiltonian-in-bethe-theory">
<h3><span class="section-number">2.16.3.1. </span>Hamiltonian in Bethe Theory<a class="headerlink" href="#hamiltonian-in-bethe-theory" title="Permalink to this heading">#</a></h3>
<p>For our diffraction experiment is often better to use a Hamiltonian that contains the wave vector:
\begin{equation}
H_0 = { -\Delta_\rho -\xi^2 }
\end{equation}</p>
<p>OOps, where is the wavevector <span class="math notranslate nohighlight">\(\vec{k}\)</span>?</p>
<p>I replaced it by <span class="math notranslate nohighlight">\(\xi\)</span> which is the effective deviation from wavevector <span class="math notranslate nohighlight">\(\vec{k}\)</span></p>
<p>We also take into account that our electrons are very fast and distort the space, reducing the problem to two dimensions (<span class="math notranslate nohighlight">\(\rho = (x,y)\)</span>.
The crystal potential V has then to be changed as well to:
\begin{equation}
V = V(\rho,z)
\end{equation}
and the full Hamiltonian is changed to:
\begin{equation}
H = \frac{1}{k_z} \left(H_0 + V(\rho,z) \right)
\end{equation}</p>
<p>The time- independent wave equation is then:
\begin{equation}
\nabla^2 \psi  + k^2 \psi = 0
\end{equation}
with the plane wave solution:
\begin{equation}
\psi  = \exp(\pm\vec{k}\bullet\vec{r}) = 0
\end{equation}</p>
</section>
</section>
<section id="schrodinger-equation-of-bethe-theory">
<h2><span class="section-number">2.16.4. </span>Schrödinger  Equation of Bethe Theory<a class="headerlink" href="#schrodinger-equation-of-bethe-theory" title="Permalink to this heading">#</a></h2>
<p>The Bethe theory is based on the (time independent, non relativistic) Schrödinger  equation:</p>
<p>\begin{equation}<br />
\Big[ \underbrace{ -\frac{h^2}{8\pi^2} \nabla^2 }<em> +\underbrace{ \mathcal{V}(\vec{r})}</em> \Big], |\psi(\vec{r}) \rangle = \underbrace{\mathcal{E}}<em> \underbrace{|\psi(\vec{r})\rangle }</em>
\end{equation}</p>
<p>What does that mean for the TEM?</p>
<blockquote>
<div><p>We have a acceleration voltage (electric field potential) <span class="math notranslate nohighlight">\(E\)</span> of 100kV</p>
<p>We have a charge of the electron <span class="math notranslate nohighlight">\(q\)</span> with the value <span class="math notranslate nohighlight">\(e\)</span>.</p>
<p>We have a total Energy <span class="math notranslate nohighlight">\(-\mathcal{E} = E\cdot q\)</span> which is just <span class="math notranslate nohighlight">\(E\)</span> in the units of <span class="math notranslate nohighlight">\([eV]\)</span>.</p>
<p>We have a crystal with the potential <span class="math notranslate nohighlight">\(V(\vec{r})\)</span>, which we declare positive inside the crystal and zero outside.</p>
<p>We have a potential Energy <span class="math notranslate nohighlight">\(\mathcal{V}(\vec{r}) = q\cdot V(\vec{r})\)</span>.</p>
</div></blockquote>
<p>Now, that we declared all our variables we can transform the Schrödinger equation we started with to:</p>
<div class="math notranslate nohighlight">
\[
\nabla^2  |\psi(\vec{r})\rangle = -\frac{8\pi m e}{h^2}\,  [E+V]\, |\psi(\vec{r})\rangle 
\]</div>
<p>The left hand part of this equation is the impulse of the electron and the right hand part consists of a total energy part, which is boring and a part which originates from the crystal (interesting!).</p>
</section>
<section id="bloch-waves-in-bethe-theory">
<h2><span class="section-number">2.16.5. </span>Bloch Waves in Bethe Theory<a class="headerlink" href="#bloch-waves-in-bethe-theory" title="Permalink to this heading">#</a></h2>
<p>Well, if the potential is periodic, then the solution (wave function) must be periodic, too.</p>
<p>First we make a substitution in case our wave function is complicated: we define it as a linear combination of other waves. That is a useful trick, which makes the mathematics easier as we’ll see in a bit.
$<span class="math notranslate nohighlight">\(
|\psi(\vec{r})\rangle = \sum_j |b_j\rangle \\
|b_j\rangle  =  = |b(\vec{k}^{(j)}, \vec{r})\rangle
\)</span>$</p>
<p>The <span class="math notranslate nohighlight">\( |b(\vec{k}^{(j)}, \vec{r})\rangle \)</span> are called Bloch waves and are only defined for specific <span class="math notranslate nohighlight">\(\vec{k}\)</span>-vectors,
because the  <span class="math notranslate nohighlight">\(|b(\vec{k}^{(j)}, \vec{r})\rangle\)</span> are plane waves, each traveling in <span class="math notranslate nohighlight">\(k^{(j)}\)</span> direction. For the <span class="math notranslate nohighlight">\(|\psi(\vec{r})\rangle\)</span> we did not and could not have made any assumption like that.\</p>
<p>Now, we express the fact that these Bloch waves are indeed plane waves mathematically:</p>
<p>\begin{equation}
|b^{(j)}(\vec{r})\rangle  = b(\vec{k}^{(j)}, \vec{r})=\mu(\vec{k}^{(j)}, \vec{r})\cdot e^{2\pi i \vec{k}^{(j)} \vec{r}} = \underbrace{\mu^{(j)}(\vec{r})}_   e^{2\pi i \vec{k}^{(j)} \vec{r}}
\end{equation}</p>
<p>by dividing it in a plane wave part (the exponential function) and a amplitude part (the Bloch function).
Because of the periodicity which we assume for the solution, we expand the Bloch waves in a into a Fourier series, again (the same as in equation \ref{FourierExpand} for the potential).</p>
<p>\begin{equation}
b^{(j)}(\vec{r}) = \sum_g C_g^{(j)} e^{2\pi i (\vec{k}^{(j)} + \vec{g}) \vec{r}}
\end{equation}
The sum in this equation goes over all excited (aha!) points in the reciprocal lattice, including the incident direction <span class="math notranslate nohighlight">\(g_1 = 0\)</span>. (  \vec{g} are defined through the Milller indices as (h/a, k/b, l/c), where the (a,b,c) are the real space lattice vectors).</p>
<p>Theoretically, there are an infinite number of <span class="math notranslate nohighlight">\(\vec{g}\)</span> vectors, but only few are allowed and only a few have a small excitation error.</p>
<p>So in practice there are only a few <span class="math notranslate nohighlight">\(\vec{g}\)</span> vectors to consider.</p>
</section>
<section id="crystal-potential-in-bethe-theory">
<h2><span class="section-number">2.16.6. </span>Crystal Potential in Bethe Theory<a class="headerlink" href="#crystal-potential-in-bethe-theory" title="Permalink to this heading">#</a></h2>
<p>The crystal potential is periodic and so we also make a Fourier expansion of that potential
$<span class="math notranslate nohighlight">\(
V = V(x,y,z) = V(\vec{r}) = \sum_g V_g \exp(2\pi i\vec{g}\cdot\vec{r})
\)</span>$</p>
<p>The Fourier component of the crystal potential (in Volts) consists of several atoms <span class="math notranslate nohighlight">\(j\)</span> over which we sum:
$<span class="math notranslate nohighlight">\(
V_g = \frac{h^2}{2 \pi m_0 e} \frac{1}{\Omega} \sum_j  f_{e_j}(\vec{g}) \exp(-2\pi i\vec{g}\cdot\vec{r_j})\\
= \frac{2 \pi  e a_0}{\Omega} \sum_j  f_{e_j}(\vec{g}) \exp(-2\pi i\vec{g}\cdot\vec{r_j})\\
\)</span>$
where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f_{e_j}\)</span>: atomic form (atomic scattering) factor of the <span class="math notranslate nohighlight">\(j\)</span>th atom</p></li>
<li><p><span class="math notranslate nohighlight">\(e\)</span>: charge of electron</p></li>
<li><p><span class="math notranslate nohighlight">\(m_0\)</span>: rest mass of electron</p></li>
<li><p><span class="math notranslate nohighlight">\(a_0\)</span>: Bohr radius</p></li>
<li><p><span class="math notranslate nohighlight">\(\Omega\)</span>: Volume of the unit cell</p></li>
</ul>
</section>
<section id="solution-of-bethe-theory">
<h2><span class="section-number">2.16.7. </span>Solution of Bethe Theory<a class="headerlink" href="#solution-of-bethe-theory" title="Permalink to this heading">#</a></h2>
<p>Now, so far we haven’t done anything, but substitute and expand. Let’s put all this into the Schrödinger equation \ref{Schrodinger}
\begin{equation}
4\pi \left[ K^2 - (k_0^{(j)} + g)^2 +\sum_{h \neq 0} U_h e^{2\pi i \vec{h}\vec{r} }  \right] \cdot C_g^{(j)} e^{2\pi i (\vec{k}<em>o^{(j)} +\vec{g})\cdot \vec{r} }= 0
\end{equation}
This can only be zero, if all coefficients with same exponential function simultaneous become zero; this results in a set of equations, after collecting up terms containing the factor
<span class="math notranslate nohighlight">\(e^{2\pi i (\vec{k}_o^{(j)} +\vec{g})\cdot \vec{r} }\)</span>:
\begin{equation}
\left[ K^2 -(\vec{k}<em>o^{(j)} +\vec{g})^2 \right] C_g^{(j)} + \sum</em>{h\neq 0} U_h C</em>{g-h}^{(j)}=0; \qquad \vec{g}=\vec{g}_1, \vec{g}_2, …, \vec{g}_n
\end{equation}</p>
<p>I made use of an abbreviation:
\begin{equation}
K=\frac{1}{h}\left[ 2m_0 E (1+\frac{E}{2E_0}) +2m_0 e U_0(1+\frac{E}{E_0}) \right]^{\frac{1}{2}}
\end{equation}
for the wave vector inside the the crystal which are not identical to the magnitude of the wave vectors of the Bloch waves <span class="math notranslate nohighlight">\(\vec{k}_g^{(j)}=\vec{k}_o^{(j)} +\vec{g}\)</span>.</p>
<p>Please note, that I introduced relativistic corrections (the terms in the round brackets in the equation above), too. It is enough to add this corrections for the energy at this point; it is not necessary to solve the Dirac equation (relativistic  Schrödinger equation).</p>
<p>The set of equations defined in \ref{setEquat} are essential for the  understanding of dynamic diffraction. Let’s look at it a little more closely.</p>
<p>We get for each <span class="math notranslate nohighlight">\(j\)</span> one equation; and this means we get for each Bloch wave one equation.</p>
<p>The second term in equation \ref{setEquat} (the term with the sum) mixes the Bloch waves (<span class="math notranslate nohighlight">\(C_{g-h}^{(j)}\)</span>). Effectively, we state that the inner potential <span class="math notranslate nohighlight">\(U_h\)</span> mixes the Bloch waves; this is called dynamical coupling.</p>
<blockquote>
<div><p><strong>In summation:</strong></p>
<p>We separated the problem!</p>
</div></blockquote>
</section>
<section id="two-beam-case">
<h2><span class="section-number">2.16.8. </span>Two Beam Case<a class="headerlink" href="#two-beam-case" title="Permalink to this heading">#</a></h2>
<p>We rewrite the matrix expression for the boundary condition in the two beam case:
\begin{equation}
\left(
\begin{matrix}
C_{0}^{(1)} &amp;  C_{0}^{(2)} \
C_{g}^{(1)} &amp; C_{g}^{(2)} \
\end{matrix}
\right) \cdot
\left(
\begin{matrix}
\epsilon^{(1)} \
\epsilon^{(2)} \
\end{matrix}
\right) =
\left(
\begin{matrix}
\phi_0^{(0)} \
\phi_g^{(0)} \
\end{matrix}
\right) =
\left(
\begin{matrix}
1 \
0\
\end{matrix}
\right)
\end{equation}</p>
<p>In the kinematic case, the centers M of the various Ewald spheres (for the various incident directions) lay on a sphere of radius <span class="math notranslate nohighlight">\(k=\frac{1}{\lambda}\)</span> around the origin of the reciprocal lattice. At some point the intensity in the diffracted beam will be more intense than in the incident beam, and therefore, we have to treat this scattered beam now in the same way we have treated the incident beam before: we need an Ewald sphere of radius <span class="math notranslate nohighlight">\(k\)</span> for this direction/ for this reciprocal lattice point <span class="math notranslate nohighlight">\(\vec{g}\)</span>. Now we have two Ewald spheres, one around the origin <span class="math notranslate nohighlight">\(0\)</span> and one around the reciprocal lattice point <span class="math notranslate nohighlight">\(\vec{g}\)</span>. The two spheres are not allowed to intersect each other, but a smooth kind of complicated surface has to be constructed.</p>
<p>The fundamental equations of the dynamic theory for the two beam case are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
-\gamma^{(j)} C_0^{j} + \frac{U_g}{2K} C_g^{(j)} = 0\\
\frac{U_g}{2K} C_0^{j} + (-\gamma^{(j)}+s) C_g^{(j)} = 0
\end{split}\]</div>
<p>Such a homogeneous linear equation system for the <span class="math notranslate nohighlight">\(C_g^{(j)}\)</span> has a non-zero solution of and only if the determinant of the coefficients is zero:</p>
<p>\begin{equation}
\left|
\begin{matrix}
-\gamma^{(j)} &amp; \frac{U_g}{2K}\
\frac{U_g}{2K}&amp; (-\gamma^{(j)}+s)\
\end{matrix}
\right| = {\gamma^{(j)}}^2 -s\gamma^{(j)}-\frac{U_g^2}{4K^2} =0
\end{equation}</p>
<p>Which is the same as the Howie-Whelan equation \ref{HaW3} with <span class="math notranslate nohighlight">\(\xi_g = K^2/U_g\)</span>,
but now we know that the <span class="math notranslate nohighlight">\(\gamma^{(j)}\)</span> are the Eigenvalues of a matrix problem.</p>
<p>Solution:
$<span class="math notranslate nohighlight">\(
\gamma^{(j)}  = \frac{1}{2} \left[ s-(-1)^j \sqrt{(U_g/K)^2 +s^2}   \right]\\
= \frac{1}{2} \left[ s-(-1)^j \sqrt{(1/\xi^2 +s^2}   \right]\\
= \frac{1}{2\xi_g} \left[ w-(-1)^j \sqrt{(1+w^2}   \right]\\
\)</span>$</p>
<p>We made the substitution <span class="math notranslate nohighlight">\(w =s\xi_g\)</span>, in which the parameter <span class="math notranslate nohighlight">\(w\)</span> characterizes the tilt out of the exact Bragg condition (<span class="math notranslate nohighlight">\(w=0\)</span>). The excitation error <span class="math notranslate nohighlight">\(s\)</span> is zero in the exact Bragg condition, isn’t it.</p>
<p>The separation is <span class="math notranslate nohighlight">\(\Delta k_{z,min} = \gamma^{(1)}-\gamma^{(2)}= \frac{U_g}{2K}=\frac{1}{\xi_g}\)</span>.</p>
<p>By use of the eigenvalues <span class="math notranslate nohighlight">\(\gamma^{(j)}\)</span>, the linear systems of equations can be solved for the <span class="math notranslate nohighlight">\(C_g^{(j)}\)</span>. For the amplitude <span class="math notranslate nohighlight">\(\epsilon^{(j)} C_g^{(j)} = C_0^{j} C_g^{(j)}\)</span> of the four Bloch waves with the vector <span class="math notranslate nohighlight">\(\vec{k}_0^{(j)}+\vec{g}\)</span> we obtain:
$<span class="math notranslate nohighlight">\(
C_0^{j} C_0^{(j)} = \frac{1}{2}\left[ 1 + (-1)^j \frac{w}{\sqrt{1+w^2}} \right]\\
C_0^{j} C_g^{(j)} = -\frac{1}{2}\left[  \frac{(-1)^j}{\sqrt{1+w^2}} \right]
\)</span>$</p>
<p>We put this into the equation for the scattered wave and substitute the thickness <span class="math notranslate nohighlight">\(t\)</span> for the <span class="math notranslate nohighlight">\(z\)</span> component of the vector <span class="math notranslate nohighlight">\(\vec{r}\)</span>:
$<span class="math notranslate nohighlight">\(
\psi_0(t) = \sum_{j=1}^2 C_0^{j} C_0^{(j)}e^{2\pi i k_z^{(j)}t}\\
\psi_g(t) = \sum_{j=1}^2 C_0^{j} C_g^{(j)}e^{2\pi i k_z^{(j)}t}\, e^{2\pi i k_z gx}
\)</span><span class="math notranslate nohighlight">\(
and we find (omitting common phase factors):
\)</span><span class="math notranslate nohighlight">\(
\psi_0(t)= \cos (\pi \sqrt{1+w^2}\frac{t}{\xi_g})  - \frac{iw}{\sqrt{1+w^2}} \sin (\pi \sqrt{1+w^2}\frac{t}{\xi_g})\\
\psi_g(t)=    \frac{i}{\sqrt{1+w^2}} \sin (\pi \sqrt{1+w^2}\frac{t}{\xi_g}) \, e^{2\pi i k_z gx}
\)</span>$</p>
<p>The intensities of the transmission <span class="math notranslate nohighlight">\(T\)</span> and reflection <span class="math notranslate nohighlight">\(R\)</span> become:
\begin{equation}
\underbrace{\psi_g \psi_g^<em>}_R = \underbrace{1-\psi_0 \psi_0^</em>}<em>{1-T} =  \frac{1}{1+w^2} \sin^2 (\pi \sqrt{\sqrt{1+w^2} ( \frac{1}{\xi_g}})</em>{s_{eff}} \cdot t)
\end{equation}</p>
<p>The solution is the Pendellösung of two coupled oscillators (in mechanics: two pendulums connected with a spring).</p>
<p>Even in exact Bragg condition, the intensity oscillates between primary beam and Bragg reflected beam with increasing film thickness. Look at the plot below, the Pendellösung is shown without absorption.</p>
<p>Normally one would want to add an absorption term to reduce the intensity with thickness. This absorption term is better named a damping term and stems form the inelatic scattering to random angles instead of the  considered (here two)  Bragg angles</p>
<p>These oscillations of the intensities are commonly called <code class="docutils literal notranslate"><span class="pre">rocking</span> <span class="pre">curve</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ------ Input ------</span>
<span class="n">xi_g</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># extiction distance (in terms of relative thickness )</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1"># tilt from Bragg condition</span>
<span class="n">damping</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="c1"># --------------------</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">401</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">xi_g</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">damping</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;incident beam&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">xi_g</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">damping</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;reflected beam&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">/* Put everything inside the global mpl namespace */
/* global mpl */
window.mpl = {};

mpl.get_websocket_type = function () {
    if (typeof WebSocket !== 'undefined') {
        return WebSocket;
    } else if (typeof MozWebSocket !== 'undefined') {
        return MozWebSocket;
    } else {
        alert(
            'Your browser does not have WebSocket support. ' +
                'Please try Chrome, Safari or Firefox ≥ 6. ' +
                'Firefox 4 and 5 are also supported but you ' +
                'have to enable WebSockets in about:config.'
        );
    }
};

mpl.figure = function (figure_id, websocket, ondownload, parent_element) {
    this.id = figure_id;

    this.ws = websocket;

    this.supports_binary = this.ws.binaryType !== undefined;

    if (!this.supports_binary) {
        var warnings = document.getElementById('mpl-warnings');
        if (warnings) {
            warnings.style.display = 'block';
            warnings.textContent =
                'This browser does not support binary websocket messages. ' +
                'Performance may be slow.';
        }
    }

    this.imageObj = new Image();

    this.context = undefined;
    this.message = undefined;
    this.canvas = undefined;
    this.rubberband_canvas = undefined;
    this.rubberband_context = undefined;
    this.format_dropdown = undefined;

    this.image_mode = 'full';

    this.root = document.createElement('div');
    this.root.setAttribute('style', 'display: inline-block');
    this._root_extra_style(this.root);

    parent_element.appendChild(this.root);

    this._init_header(this);
    this._init_canvas(this);
    this._init_toolbar(this);

    var fig = this;

    this.waiting = false;

    this.ws.onopen = function () {
        fig.send_message('supports_binary', { value: fig.supports_binary });
        fig.send_message('send_image_mode', {});
        if (fig.ratio !== 1) {
            fig.send_message('set_device_pixel_ratio', {
                device_pixel_ratio: fig.ratio,
            });
        }
        fig.send_message('refresh', {});
    };

    this.imageObj.onload = function () {
        if (fig.image_mode === 'full') {
            // Full images could contain transparency (where diff images
            // almost always do), so we need to clear the canvas so that
            // there is no ghosting.
            fig.context.clearRect(0, 0, fig.canvas.width, fig.canvas.height);
        }
        fig.context.drawImage(fig.imageObj, 0, 0);
    };

    this.imageObj.onunload = function () {
        fig.ws.close();
    };

    this.ws.onmessage = this._make_on_message_function(this);

    this.ondownload = ondownload;
};

mpl.figure.prototype._init_header = function () {
    var titlebar = document.createElement('div');
    titlebar.classList =
        'ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix';
    var titletext = document.createElement('div');
    titletext.classList = 'ui-dialog-title';
    titletext.setAttribute(
        'style',
        'width: 100%; text-align: center; padding: 3px;'
    );
    titlebar.appendChild(titletext);
    this.root.appendChild(titlebar);
    this.header = titletext;
};

mpl.figure.prototype._canvas_extra_style = function (_canvas_div) {};

mpl.figure.prototype._root_extra_style = function (_canvas_div) {};

mpl.figure.prototype._init_canvas = function () {
    var fig = this;

    var canvas_div = (this.canvas_div = document.createElement('div'));
    canvas_div.setAttribute('tabindex', '0');
    canvas_div.setAttribute(
        'style',
        'border: 1px solid #ddd;' +
            'box-sizing: content-box;' +
            'clear: both;' +
            'min-height: 1px;' +
            'min-width: 1px;' +
            'outline: 0;' +
            'overflow: hidden;' +
            'position: relative;' +
            'resize: both;' +
            'z-index: 2;'
    );

    function on_keyboard_event_closure(name) {
        return function (event) {
            return fig.key_event(event, name);
        };
    }

    canvas_div.addEventListener(
        'keydown',
        on_keyboard_event_closure('key_press')
    );
    canvas_div.addEventListener(
        'keyup',
        on_keyboard_event_closure('key_release')
    );

    this._canvas_extra_style(canvas_div);
    this.root.appendChild(canvas_div);

    var canvas = (this.canvas = document.createElement('canvas'));
    canvas.classList.add('mpl-canvas');
    canvas.setAttribute(
        'style',
        'box-sizing: content-box;' +
            'pointer-events: none;' +
            'position: relative;' +
            'z-index: 0;'
    );

    this.context = canvas.getContext('2d');

    var backingStore =
        this.context.backingStorePixelRatio ||
        this.context.webkitBackingStorePixelRatio ||
        this.context.mozBackingStorePixelRatio ||
        this.context.msBackingStorePixelRatio ||
        this.context.oBackingStorePixelRatio ||
        this.context.backingStorePixelRatio ||
        1;

    this.ratio = (window.devicePixelRatio || 1) / backingStore;

    var rubberband_canvas = (this.rubberband_canvas = document.createElement(
        'canvas'
    ));
    rubberband_canvas.setAttribute(
        'style',
        'box-sizing: content-box;' +
            'left: 0;' +
            'pointer-events: none;' +
            'position: absolute;' +
            'top: 0;' +
            'z-index: 1;'
    );

    // Apply a ponyfill if ResizeObserver is not implemented by browser.
    if (this.ResizeObserver === undefined) {
        if (window.ResizeObserver !== undefined) {
            this.ResizeObserver = window.ResizeObserver;
        } else {
            var obs = _JSXTOOLS_RESIZE_OBSERVER({});
            this.ResizeObserver = obs.ResizeObserver;
        }
    }

    this.resizeObserverInstance = new this.ResizeObserver(function (entries) {
        var nentries = entries.length;
        for (var i = 0; i < nentries; i++) {
            var entry = entries[i];
            var width, height;
            if (entry.contentBoxSize) {
                if (entry.contentBoxSize instanceof Array) {
                    // Chrome 84 implements new version of spec.
                    width = entry.contentBoxSize[0].inlineSize;
                    height = entry.contentBoxSize[0].blockSize;
                } else {
                    // Firefox implements old version of spec.
                    width = entry.contentBoxSize.inlineSize;
                    height = entry.contentBoxSize.blockSize;
                }
            } else {
                // Chrome <84 implements even older version of spec.
                width = entry.contentRect.width;
                height = entry.contentRect.height;
            }

            // Keep the size of the canvas and rubber band canvas in sync with
            // the canvas container.
            if (entry.devicePixelContentBoxSize) {
                // Chrome 84 implements new version of spec.
                canvas.setAttribute(
                    'width',
                    entry.devicePixelContentBoxSize[0].inlineSize
                );
                canvas.setAttribute(
                    'height',
                    entry.devicePixelContentBoxSize[0].blockSize
                );
            } else {
                canvas.setAttribute('width', width * fig.ratio);
                canvas.setAttribute('height', height * fig.ratio);
            }
            /* This rescales the canvas back to display pixels, so that it
             * appears correct on HiDPI screens. */
            canvas.style.width = width + 'px';
            canvas.style.height = height + 'px';

            rubberband_canvas.setAttribute('width', width);
            rubberband_canvas.setAttribute('height', height);

            // And update the size in Python. We ignore the initial 0/0 size
            // that occurs as the element is placed into the DOM, which should
            // otherwise not happen due to the minimum size styling.
            if (fig.ws.readyState == 1 && width != 0 && height != 0) {
                fig.request_resize(width, height);
            }
        }
    });
    this.resizeObserverInstance.observe(canvas_div);

    function on_mouse_event_closure(name) {
        /* User Agent sniffing is bad, but WebKit is busted:
         * https://bugs.webkit.org/show_bug.cgi?id=144526
         * https://bugs.webkit.org/show_bug.cgi?id=181818
         * The worst that happens here is that they get an extra browser
         * selection when dragging, if this check fails to catch them.
         */
        var UA = navigator.userAgent;
        var isWebKit = /AppleWebKit/.test(UA) && !/Chrome/.test(UA);
        if(isWebKit) {
            return function (event) {
                /* This prevents the web browser from automatically changing to
                 * the text insertion cursor when the button is pressed. We
                 * want to control all of the cursor setting manually through
                 * the 'cursor' event from matplotlib */
                event.preventDefault()
                return fig.mouse_event(event, name);
            };
        } else {
            return function (event) {
                return fig.mouse_event(event, name);
            };
        }
    }

    canvas_div.addEventListener(
        'mousedown',
        on_mouse_event_closure('button_press')
    );
    canvas_div.addEventListener(
        'mouseup',
        on_mouse_event_closure('button_release')
    );
    canvas_div.addEventListener(
        'dblclick',
        on_mouse_event_closure('dblclick')
    );
    // Throttle sequential mouse events to 1 every 20ms.
    canvas_div.addEventListener(
        'mousemove',
        on_mouse_event_closure('motion_notify')
    );

    canvas_div.addEventListener(
        'mouseenter',
        on_mouse_event_closure('figure_enter')
    );
    canvas_div.addEventListener(
        'mouseleave',
        on_mouse_event_closure('figure_leave')
    );

    canvas_div.addEventListener('wheel', function (event) {
        if (event.deltaY < 0) {
            event.step = 1;
        } else {
            event.step = -1;
        }
        on_mouse_event_closure('scroll')(event);
    });

    canvas_div.appendChild(canvas);
    canvas_div.appendChild(rubberband_canvas);

    this.rubberband_context = rubberband_canvas.getContext('2d');
    this.rubberband_context.strokeStyle = '#000000';

    this._resize_canvas = function (width, height, forward) {
        if (forward) {
            canvas_div.style.width = width + 'px';
            canvas_div.style.height = height + 'px';
        }
    };

    // Disable right mouse context menu.
    canvas_div.addEventListener('contextmenu', function (_e) {
        event.preventDefault();
        return false;
    });

    function set_focus() {
        canvas.focus();
        canvas_div.focus();
    }

    window.setTimeout(set_focus, 100);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'mpl-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'mpl-button-group';
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'mpl-button-group';
            continue;
        }

        var button = (fig.buttons[name] = document.createElement('button'));
        button.classList = 'mpl-widget';
        button.setAttribute('role', 'button');
        button.setAttribute('aria-disabled', 'false');
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));

        var icon_img = document.createElement('img');
        icon_img.src = '_images/' + image + '.png';
        icon_img.srcset = '_images/' + image + '_large.png 2x';
        icon_img.alt = tooltip;
        button.appendChild(icon_img);

        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    var fmt_picker = document.createElement('select');
    fmt_picker.classList = 'mpl-widget';
    toolbar.appendChild(fmt_picker);
    this.format_dropdown = fmt_picker;

    for (var ind in mpl.extensions) {
        var fmt = mpl.extensions[ind];
        var option = document.createElement('option');
        option.selected = fmt === mpl.default_extension;
        option.innerHTML = fmt;
        fmt_picker.appendChild(option);
    }

    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message';
    toolbar.appendChild(status_bar);
    this.message = status_bar;
};

mpl.figure.prototype.request_resize = function (x_pixels, y_pixels) {
    // Request matplotlib to resize the figure. Matplotlib will then trigger a resize in the client,
    // which will in turn request a refresh of the image.
    this.send_message('resize', { width: x_pixels, height: y_pixels });
};

mpl.figure.prototype.send_message = function (type, properties) {
    properties['type'] = type;
    properties['figure_id'] = this.id;
    this.ws.send(JSON.stringify(properties));
};

mpl.figure.prototype.send_draw_message = function () {
    if (!this.waiting) {
        this.waiting = true;
        this.ws.send(JSON.stringify({ type: 'draw', figure_id: this.id }));
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    var format_dropdown = fig.format_dropdown;
    var format = format_dropdown.options[format_dropdown.selectedIndex].value;
    fig.ondownload(fig, format);
};

mpl.figure.prototype.handle_resize = function (fig, msg) {
    var size = msg['size'];
    if (size[0] !== fig.canvas.width || size[1] !== fig.canvas.height) {
        fig._resize_canvas(size[0], size[1], msg['forward']);
        fig.send_message('refresh', {});
    }
};

mpl.figure.prototype.handle_rubberband = function (fig, msg) {
    var x0 = msg['x0'] / fig.ratio;
    var y0 = (fig.canvas.height - msg['y0']) / fig.ratio;
    var x1 = msg['x1'] / fig.ratio;
    var y1 = (fig.canvas.height - msg['y1']) / fig.ratio;
    x0 = Math.floor(x0) + 0.5;
    y0 = Math.floor(y0) + 0.5;
    x1 = Math.floor(x1) + 0.5;
    y1 = Math.floor(y1) + 0.5;
    var min_x = Math.min(x0, x1);
    var min_y = Math.min(y0, y1);
    var width = Math.abs(x1 - x0);
    var height = Math.abs(y1 - y0);

    fig.rubberband_context.clearRect(
        0,
        0,
        fig.canvas.width / fig.ratio,
        fig.canvas.height / fig.ratio
    );

    fig.rubberband_context.strokeRect(min_x, min_y, width, height);
};

mpl.figure.prototype.handle_figure_label = function (fig, msg) {
    // Updates the figure title.
    fig.header.textContent = msg['label'];
};

mpl.figure.prototype.handle_cursor = function (fig, msg) {
    fig.canvas_div.style.cursor = msg['cursor'];
};

mpl.figure.prototype.handle_message = function (fig, msg) {
    fig.message.textContent = msg['message'];
};

mpl.figure.prototype.handle_draw = function (fig, _msg) {
    // Request the server to send over a new figure.
    fig.send_draw_message();
};

mpl.figure.prototype.handle_image_mode = function (fig, msg) {
    fig.image_mode = msg['mode'];
};

mpl.figure.prototype.handle_history_buttons = function (fig, msg) {
    for (var key in msg) {
        if (!(key in fig.buttons)) {
            continue;
        }
        fig.buttons[key].disabled = !msg[key];
        fig.buttons[key].setAttribute('aria-disabled', !msg[key]);
    }
};

mpl.figure.prototype.handle_navigate_mode = function (fig, msg) {
    if (msg['mode'] === 'PAN') {
        fig.buttons['Pan'].classList.add('active');
        fig.buttons['Zoom'].classList.remove('active');
    } else if (msg['mode'] === 'ZOOM') {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.add('active');
    } else {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.remove('active');
    }
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Called whenever the canvas gets updated.
    this.send_message('ack', {});
};

// A function to construct a web socket function for onmessage handling.
// Called in the figure constructor.
mpl.figure.prototype._make_on_message_function = function (fig) {
    return function socket_on_message(evt) {
        if (evt.data instanceof Blob) {
            var img = evt.data;
            if (img.type !== 'image/png') {
                /* FIXME: We get "Resource interpreted as Image but
                 * transferred with MIME type text/plain:" errors on
                 * Chrome.  But how to set the MIME type?  It doesn't seem
                 * to be part of the websocket stream */
                img.type = 'image/png';
            }

            /* Free the memory for the previous frames */
            if (fig.imageObj.src) {
                (window.URL || window.webkitURL).revokeObjectURL(
                    fig.imageObj.src
                );
            }

            fig.imageObj.src = (window.URL || window.webkitURL).createObjectURL(
                img
            );
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        } else if (
            typeof evt.data === 'string' &&
            evt.data.slice(0, 21) === 'data:image/png;base64'
        ) {
            fig.imageObj.src = evt.data;
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        }

        var msg = JSON.parse(evt.data);
        var msg_type = msg['type'];

        // Call the  "handle_{type}" callback, which takes
        // the figure and JSON message as its only arguments.
        try {
            var callback = fig['handle_' + msg_type];
        } catch (e) {
            console.log(
                "No handler for the '" + msg_type + "' message type: ",
                msg
            );
            return;
        }

        if (callback) {
            try {
                // console.log("Handling '" + msg_type + "' message: ", msg);
                callback(fig, msg);
            } catch (e) {
                console.log(
                    "Exception inside the 'handler_" + msg_type + "' callback:",
                    e,
                    e.stack,
                    msg
                );
            }
        }
    };
};


/*
 * return a copy of an object with only non-object keys
 * we need this to avoid circular references
 * https://stackoverflow.com/a/24161582/3208463
 */
function simpleKeys(original) {
    return Object.keys(original).reduce(function (obj, key) {
        if (typeof original[key] !== 'object') {
            obj[key] = original[key];
        }
        return obj;
    }, {});
}

mpl.figure.prototype.mouse_event = function (event, name) {
    if (name === 'button_press') {
        this.canvas.focus();
        this.canvas_div.focus();
    }

    // from https://stackoverflow.com/q/1114465
    var boundingRect = this.canvas.getBoundingClientRect();
    var x = (event.clientX - boundingRect.left) * this.ratio;
    var y = (event.clientY - boundingRect.top) * this.ratio;

    this.send_message(name, {
        x: x,
        y: y,
        button: event.button,
        step: event.step,
        guiEvent: simpleKeys(event),
    });

    return false;
};

mpl.figure.prototype._key_event_extra = function (_event, _name) {
    // Handle any extra behaviour associated with a key event
};

mpl.figure.prototype.key_event = function (event, name) {
    // Prevent repeat events
    if (name === 'key_press') {
        if (event.key === this._key) {
            return;
        } else {
            this._key = event.key;
        }
    }
    if (name === 'key_release') {
        this._key = null;
    }

    var value = '';
    if (event.ctrlKey && event.key !== 'Control') {
        value += 'ctrl+';
    }
    else if (event.altKey && event.key !== 'Alt') {
        value += 'alt+';
    }
    else if (event.shiftKey && event.key !== 'Shift') {
        value += 'shift+';
    }

    value += 'k' + event.key;

    this._key_event_extra(event, name);

    this.send_message(name, { key: value, guiEvent: simpleKeys(event) });
    return false;
};

mpl.figure.prototype.toolbar_button_onclick = function (name) {
    if (name === 'download') {
        this.handle_save(this, null);
    } else {
        this.send_message('toolbar_button', { name: name });
    }
};

mpl.figure.prototype.toolbar_button_onmouseover = function (tooltip) {
    this.message.textContent = tooltip;
};

///////////////// REMAINING CONTENT GENERATED BY embed_js.py /////////////////
// prettier-ignore
var _JSXTOOLS_RESIZE_OBSERVER=function(A){var t,i=new WeakMap,n=new WeakMap,a=new WeakMap,r=new WeakMap,o=new Set;function s(e){if(!(this instanceof s))throw new TypeError("Constructor requires 'new' operator");i.set(this,e)}function h(){throw new TypeError("Function is not a constructor")}function c(e,t,i,n){e=0 in arguments?Number(arguments[0]):0,t=1 in arguments?Number(arguments[1]):0,i=2 in arguments?Number(arguments[2]):0,n=3 in arguments?Number(arguments[3]):0,this.right=(this.x=this.left=e)+(this.width=i),this.bottom=(this.y=this.top=t)+(this.height=n),Object.freeze(this)}function d(){t=requestAnimationFrame(d);var s=new WeakMap,p=new Set;o.forEach((function(t){r.get(t).forEach((function(i){var r=t instanceof window.SVGElement,o=a.get(t),d=r?0:parseFloat(o.paddingTop),f=r?0:parseFloat(o.paddingRight),l=r?0:parseFloat(o.paddingBottom),u=r?0:parseFloat(o.paddingLeft),g=r?0:parseFloat(o.borderTopWidth),m=r?0:parseFloat(o.borderRightWidth),w=r?0:parseFloat(o.borderBottomWidth),b=u+f,F=d+l,v=(r?0:parseFloat(o.borderLeftWidth))+m,W=g+w,y=r?0:t.offsetHeight-W-t.clientHeight,E=r?0:t.offsetWidth-v-t.clientWidth,R=b+v,z=F+W,M=r?t.width:parseFloat(o.width)-R-E,O=r?t.height:parseFloat(o.height)-z-y;if(n.has(t)){var k=n.get(t);if(k[0]===M&&k[1]===O)return}n.set(t,[M,O]);var S=Object.create(h.prototype);S.target=t,S.contentRect=new c(u,d,M,O),s.has(i)||(s.set(i,[]),p.add(i)),s.get(i).push(S)}))})),p.forEach((function(e){i.get(e).call(e,s.get(e),e)}))}return s.prototype.observe=function(i){if(i instanceof window.Element){r.has(i)||(r.set(i,new Set),o.add(i),a.set(i,window.getComputedStyle(i)));var n=r.get(i);n.has(this)||n.add(this),cancelAnimationFrame(t),t=requestAnimationFrame(d)}},s.prototype.unobserve=function(i){if(i instanceof window.Element&&r.has(i)){var n=r.get(i);n.has(this)&&(n.delete(this),n.size||(r.delete(i),o.delete(i))),n.size||r.delete(i),o.size||cancelAnimationFrame(t)}},A.DOMRectReadOnly=c,A.ResizeObserver=s,A.ResizeObserverEntry=h,A}; // eslint-disable-line
mpl.toolbar_items = [["Home", "Reset original view", "fa fa-home", "home"], ["Back", "Back to previous view", "fa fa-arrow-left", "back"], ["Forward", "Forward to next view", "fa fa-arrow-right", "forward"], ["", "", "", ""], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "fa fa-arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "fa fa-square-o", "zoom"], ["", "", "", ""], ["Download", "Download plot", "fa fa-floppy-o", "download"]];

mpl.extensions = ["eps", "jpeg", "pgf", "pdf", "png", "ps", "raw", "svg", "tif", "webp"];

mpl.default_extension = "png";/* global mpl */

var comm_websocket_adapter = function (comm) {
    // Create a "websocket"-like object which calls the given IPython comm
    // object with the appropriate methods. Currently this is a non binary
    // socket, so there is still some room for performance tuning.
    var ws = {};

    ws.binaryType = comm.kernel.ws.binaryType;
    ws.readyState = comm.kernel.ws.readyState;
    function updateReadyState(_event) {
        if (comm.kernel.ws) {
            ws.readyState = comm.kernel.ws.readyState;
        } else {
            ws.readyState = 3; // Closed state.
        }
    }
    comm.kernel.ws.addEventListener('open', updateReadyState);
    comm.kernel.ws.addEventListener('close', updateReadyState);
    comm.kernel.ws.addEventListener('error', updateReadyState);

    ws.close = function () {
        comm.close();
    };
    ws.send = function (m) {
        //console.log('sending', m);
        comm.send(m);
    };
    // Register the callback with on_msg.
    comm.on_msg(function (msg) {
        //console.log('receiving', msg['content']['data'], msg);
        var data = msg['content']['data'];
        if (data['blob'] !== undefined) {
            data = {
                data: new Blob(msg['buffers'], { type: data['blob'] }),
            };
        }
        // Pass the mpl event to the overridden (by mpl) onmessage function.
        ws.onmessage(data);
    });
    return ws;
};

mpl.mpl_figure_comm = function (comm, msg) {
    // This is the function which gets called when the mpl process
    // starts-up an IPython Comm through the "matplotlib" channel.

    var id = msg.content.data.id;
    // Get hold of the div created by the display call when the Comm
    // socket was opened in Python.
    var element = document.getElementById(id);
    var ws_proxy = comm_websocket_adapter(comm);

    function ondownload(figure, _format) {
        window.open(figure.canvas.toDataURL());
    }

    var fig = new mpl.figure(id, ws_proxy, ondownload, element);

    // Call onopen now - mpl needs it, as it is assuming we've passed it a real
    // web socket which is closed, not our websocket->open comm proxy.
    ws_proxy.onopen();

    fig.parent_element = element;
    fig.cell_info = mpl.find_output_cell("<div id='" + id + "'></div>");
    if (!fig.cell_info) {
        console.error('Failed to find cell for figure', id, fig);
        return;
    }
    fig.cell_info[0].output_area.element.on(
        'cleared',
        { fig: fig },
        fig._remove_fig_handler
    );
};

mpl.figure.prototype.handle_close = function (fig, msg) {
    var width = fig.canvas.width / fig.ratio;
    fig.cell_info[0].output_area.element.off(
        'cleared',
        fig._remove_fig_handler
    );
    fig.resizeObserverInstance.unobserve(fig.canvas_div);

    // Update the output cell to use the data from the current canvas.
    fig.push_to_output();
    var dataURL = fig.canvas.toDataURL();
    // Re-enable the keyboard manager in IPython - without this line, in FF,
    // the notebook keyboard shortcuts fail.
    IPython.keyboard_manager.enable();
    fig.parent_element.innerHTML =
        '<img src="' + dataURL + '" width="' + width + '">';
    fig.close_ws(fig, msg);
};

mpl.figure.prototype.close_ws = function (fig, msg) {
    fig.send_message('closing', msg);
    // fig.ws.close()
};

mpl.figure.prototype.push_to_output = function (_remove_interactive) {
    // Turn the data on the canvas into data in the output cell.
    var width = this.canvas.width / this.ratio;
    var dataURL = this.canvas.toDataURL();
    this.cell_info[1]['text/html'] =
        '<img src="' + dataURL + '" width="' + width + '">';
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Tell IPython that the notebook contents must change.
    IPython.notebook.set_dirty(true);
    this.send_message('ack', {});
    var fig = this;
    // Wait a second, then push the new image to the DOM so
    // that it is saved nicely (might be nice to debounce this).
    setTimeout(function () {
        fig.push_to_output();
    }, 1000);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'btn-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'btn-group';
    var button;
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'btn-group';
            continue;
        }

        button = fig.buttons[name] = document.createElement('button');
        button.classList = 'btn btn-default';
        button.href = '#';
        button.title = name;
        button.innerHTML = '<i class="fa ' + image + ' fa-lg"></i>';
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));
        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    // Add the status bar.
    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message pull-right';
    toolbar.appendChild(status_bar);
    this.message = status_bar;

    // Add the close button to the window.
    var buttongrp = document.createElement('div');
    buttongrp.classList = 'btn-group inline pull-right';
    button = document.createElement('button');
    button.classList = 'btn btn-mini btn-primary';
    button.href = '#';
    button.title = 'Stop Interaction';
    button.innerHTML = '<i class="fa fa-power-off icon-remove icon-large"></i>';
    button.addEventListener('click', function (_evt) {
        fig.handle_close(fig, {});
    });
    button.addEventListener(
        'mouseover',
        on_mouseover_closure('Stop Interaction')
    );
    buttongrp.appendChild(button);
    var titlebar = this.root.querySelector('.ui-dialog-titlebar');
    titlebar.insertBefore(buttongrp, titlebar.firstChild);
};

mpl.figure.prototype._remove_fig_handler = function (event) {
    var fig = event.data.fig;
    if (event.target !== this) {
        // Ignore bubbled events from children.
        return;
    }
    fig.close_ws(fig, {});
};

mpl.figure.prototype._root_extra_style = function (el) {
    el.style.boxSizing = 'content-box'; // override notebook setting of border-box.
};

mpl.figure.prototype._canvas_extra_style = function (el) {
    // this is important to make the div 'focusable
    el.setAttribute('tabindex', 0);
    // reach out to IPython and tell the keyboard manager to turn it's self
    // off when our div gets focus

    // location in version 3
    if (IPython.notebook.keyboard_manager) {
        IPython.notebook.keyboard_manager.register_events(el);
    } else {
        // location in version 2
        IPython.keyboard_manager.register_events(el);
    }
};

mpl.figure.prototype._key_event_extra = function (event, _name) {
    // Check for shift+enter
    if (event.shiftKey && event.which === 13) {
        this.canvas_div.blur();
        // select the cell after this one
        var index = IPython.notebook.find_cell_index(this.cell_info[0]);
        IPython.notebook.select(index + 1);
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    fig.ondownload(fig, null);
};

mpl.find_output_cell = function (html_output) {
    // Return the cell and output element which can be found *uniquely* in the notebook.
    // Note - this is a bit hacky, but it is done because the "notebook_saving.Notebook"
    // IPython event is triggered only after the cells have been serialised, which for
    // our purposes (turning an active figure into a static one), is too late.
    var cells = IPython.notebook.get_cells();
    var ncells = cells.length;
    for (var i = 0; i < ncells; i++) {
        var cell = cells[i];
        if (cell.cell_type === 'code') {
            for (var j = 0; j < cell.output_area.outputs.length; j++) {
                var data = cell.output_area.outputs[j];
                if (data.data) {
                    // IPython >= 3 moved mimebundle to data attribute of output
                    data = data.data;
                }
                if (data['text/html'] === html_output) {
                    return [cell, data, j];
                }
            }
        }
    }
};

// Register the function which deals with the matplotlib target/channel.
// The kernel may be null if the page has been refreshed.
if (IPython.notebook.kernel !== null) {
    IPython.notebook.kernel.comm_manager.register_target(
        'matplotlib',
        mpl.mpl_figure_comm
    );
}
</script><div class="output text_html"><div id='9f06f804-be8f-4dfe-a845-7c60fd9c2a6b'></div></div></div>
</div>
</section>
<section id="summary-of-bethe-theory">
<h2><span class="section-number">2.16.9. </span>Summary of Bethe Theory<a class="headerlink" href="#summary-of-bethe-theory" title="Permalink to this heading">#</a></h2>
<p>The solution is the Pendellösung of two coupled oscillators.</p>
<p>The periodicity is the extinction length <span class="math notranslate nohighlight">\(\xi\)</span>, which tells at which thickness a beam is completely vanished.</p>
<p>Considering some absorption (well it’s not a real absorption, but inelastic scattering) then we see that the amplitudes decrease slowly.</p>
</section>
<section id="using-bethe-theory-for-thickness-determination">
<h2><span class="section-number">2.16.10. </span>Using Bethe Theory for Thickness Determination<a class="headerlink" href="#using-bethe-theory-for-thickness-determination" title="Permalink to this heading">#</a></h2>
<p>We will do this in a lab and it will be your homework.</p>
<ul class="simple">
<li><p>The accurate thickness of the sample is an important but hard to obtain parameter, but it influences the contrast in all imaging modes.</p></li>
<li><p>Be aware that with different techniques you perform different thickness measurement. In any high resolution image and diffraction experiment, you always look at the thickness of the crystalline part of the sample, omitting the contribution of contamination and amorphous surface layer (from sample preparation).</p></li>
<li><p>In the Analytic Section of this class we learn how to the thickness from the  whole sample.</p></li>
</ul>
<p>We can observe the above rocking curve in convergent beam electron diffraction patterns (CBED).</p>
<p>But we have to ensure that:</p>
<ul class="simple">
<li><p>Excitation error is as small as possible</p></li>
<li><p>We are in two beam condition</p></li>
</ul>
<section id="experimental-considerations">
<h3><span class="section-number">2.16.10.1. </span>Experimental Considerations<a class="headerlink" href="#experimental-considerations" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Choose a convergence angle <span class="math notranslate nohighlight">\(\alpha\)</span> so that <span class="math notranslate nohighlight">\(\alpha &lt; \theta_B\)</span>, to avoid overlapping of disks in the ZOLZ.</p></li>
<li><p>The 000 disk usually contains concentric diffuse fringes, the Kossel-Möllenstedt fringes</p></li>
<li><p>If you move the specimen, then you will see that the number of this fringes changes. In fact the number of each fringes increases by one every time the thickness increases by one extinction length.</p></li>
<li><p>The foil thickness can be measured precisely at the point where you do your other analysis.</p></li>
</ul>
<p>Please be aware that dynamic effects also occur for the HOLZ lines in a CBED pattern.</p>
<p>In practice to simplify the interpretation, we don’t use zone axis conditions, but tilt to two–beam conditions with only one strongly excited Bragg beam.</p>
<ul class="simple">
<li><p>The CBED disks contain then parallel rather than concentric intensity oscillations as shown in the earlier figure.</p></li>
<li><p>In fact, this intensity oscillations are equivalent to the rocking curve intensity oscillations discussed earlier.</p></li>
<li><p>It helps, of you use an energy filter for this method.</p></li>
</ul>
</section>
<section id="thickness-determination">
<h3><span class="section-number">2.16.10.2. </span>Thickness Determination<a class="headerlink" href="#thickness-determination" title="Permalink to this heading">#</a></h3>
<p>Because the oscillations are symmetric in the hkl disk we concentrate the analysis on this disk.</p>
<ul class="simple">
<li><p>The middle of the hkl disk is bright and originates from the exact Bragg condition (<span class="math notranslate nohighlight">\(\vec{s}=0\)</span>).</p></li>
<li><p>We measure the distance between the midle (bright fringe) of the <span class="math notranslate nohighlight">\(hkl\)</span> disk and the dark lines.</p></li>
</ul>
<p>You obtain a deviation <span class="math notranslate nohighlight">\(s_i\)</span> for each fringe from the equation:
\begin{equation}
s_i=\lambda\frac{\Delta\theta_i}{e\theta_B d^2}
\end{equation}
The Bragg angle <span class="math notranslate nohighlight">\(\theta_B\)</span> is known from the separation of two disks and the lattice spacing <span class="math notranslate nohighlight">\(d\)</span> is known from the sample or can be calculated through the camera length.</p>
<p>If the extinction distance <span class="math notranslate nohighlight">\(\xi_g\)</span> is known you can calculate the foil thickness <span class="math notranslate nohighlight">\(t\)</span> with:
\begin{equation}
\frac{1}{t^2} = \frac{s_1^2}{n_k^2}+\frac{1}{\xi_g^2n_k^2}
\end{equation}
where <span class="math notranslate nohighlight">\(n_k\)</span> is an integer.</p>
</section>
<section id="data-analysis">
<h3><span class="section-number">2.16.10.3. </span>Data Analysis<a class="headerlink" href="#data-analysis" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>assign <span class="math notranslate nohighlight">\(n=1\)</span> to the first fringe <span class="math notranslate nohighlight">\(s_1\)</span></p></li>
<li><p>assign <span class="math notranslate nohighlight">\(n=2\)</span> to the second fringe <span class="math notranslate nohighlight">\(s_2\)</span>
and so on for all other fringes</p></li>
<li><p>plot <span class="math notranslate nohighlight">\((s_1/n_k)^2\)</span> versus <span class="math notranslate nohighlight">\((1/n_k)^2\)</span>.</p></li>
<li><p>if you get a straight line, then you are finished and you have <span class="math notranslate nohighlight">\(k=i+j\)</span>, where <span class="math notranslate nohighlight">\(j\)</span> is the largest integer <span class="math notranslate nohighlight">\(&lt;(t/\xi_g)\)</span>.</p></li>
<li><p>if not repeat the same thing with <span class="math notranslate nohighlight">\(n=2\)</span> for <span class="math notranslate nohighlight">\(s_1\)</span>, <span class="math notranslate nohighlight">\(n=3\)</span> for <span class="math notranslate nohighlight">\(s_2\)</span>, etc.</p></li>
<li><p>repeat this increase by one till you get a straight line</p></li>
<li><p>the slope of the line is <span class="math notranslate nohighlight">\(1/\xi_g^2\)</span></p></li>
<li><p>the extrapolated value for <span class="math notranslate nohighlight">\(1/n_k^2\)</span> is <span class="math notranslate nohighlight">\(1/t^2\)</span>.</p></li>
</ul>
<p>The whole procedure is summarized in the figure below.</p>
<p><img alt="CBED-thickness" src="../_images/CBED-thickness.jpg" /></p>
</section>
</section>
<section id="more-about-bloch-waves">
<h2><span class="section-number">2.16.11. </span>More about Bloch Waves<a class="headerlink" href="#more-about-bloch-waves" title="Permalink to this heading">#</a></h2>
<p>We can replace the  exponential functions by trigonometric functions and get:
$<span class="math notranslate nohighlight">\(
A^{(1)} = \cos \frac{\beta}{2}\\
A^{(2)} = \sin \frac{\beta}{2}
\)</span>$
Some of the Bloch waves are located (have their maxima) between the atoms. These Bloch waves channel and are more or less undisturbed.</p>
<p>Another set is located on the atomic rows and will cause much more inelastic scattering than the other, also they will travel much faster.</p>
<p>The second set is especially important for Z-contrast image, where a small convergent beam is located at the atomic rows. You might consider the atoms like little lenses which keep the beam focused on the column.</p>
</section>
<section id="navigation">
<h2><span class="section-number">2.16.12. </span>Navigation<a class="headerlink" href="#navigation" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><font size = "3">  <strong>Next: <a class="reference internal" href="CH2_D03-Multislice_CBED.html"><span class="doc std std-doc">Mutli-Slice CBED</span></a></strong> </font></p></li>
<li><p><font size = "3">  <strong>Chapter 2: <a class="reference internal" href="CH2_00-Diffraction.html"><span class="doc std std-doc">Diffraction</span></a></strong> </font></p></li>
<li><p><font size = "3">  <strong>List of Content: <a class="reference internal" href="../_MSE672_Intro_TEM.html"><span class="doc std std-doc">Front</span></a></strong> </font></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Diffraction"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="CH2_12-HOLZ_Example.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2.13. </span>Lattice Determination with HOLZ</p>
      </div>
    </a>
    <a class="right-next"
       href="CH2_D02-Multislice.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.17. </span>Multislice Algorithm</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-numerical-and-plotting-python-packages">2.16.1. Import numerical and plotting python packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notation">2.16.2. Notation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-bethe-theory">2.16.3. Introduction to Bethe Theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hamiltonian-in-bethe-theory">2.16.3.1. Hamiltonian in Bethe Theory</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#schrodinger-equation-of-bethe-theory">2.16.4. Schrödinger  Equation of Bethe Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bloch-waves-in-bethe-theory">2.16.5. Bloch Waves in Bethe Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#crystal-potential-in-bethe-theory">2.16.6. Crystal Potential in Bethe Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-of-bethe-theory">2.16.7. Solution of Bethe Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-beam-case">2.16.8. Two Beam Case</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-bethe-theory">2.16.9. Summary of Bethe Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-bethe-theory-for-thickness-determination">2.16.10. Using Bethe Theory for Thickness Determination</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#experimental-considerations">2.16.10.1. Experimental Considerations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thickness-determination">2.16.10.2. Thickness Determination</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-analysis">2.16.10.3. Data Analysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-about-bloch-waves">2.16.11. More about Bloch Waves</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#navigation">2.16.12. Navigation</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gerd Duscher UTK/IAMM
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>